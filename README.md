# ContactManager 联系人管理系统

一个基于 C++ 的命令行联系人管理系统，支持联系人的增删改查、文件存储和关系网络构建。

## 功能特性

- **文件管理**：从 `contactList/` 目录加载联系人文件
- **查询功能**：查看所有联系人或查询特定联系人详情
- **添加联系人**：为已有人员添加新的联系人
- **修改信息**：按姓名修改联系人信息
- **删除联系人**：按姓名删除联系人记录
- **保存数据**：将联系人信息保存到文件
- **关系网络**：构建并显示联系人关系矩阵

## 项目结构

```
ContactManager/
├──src/
   ├── main.cpp           # 程序入口
   ├── App.cpp/h          # 应用主控制器
   ├── Service.cpp/h      # 业务逻辑层
   ├── DataManager.cpp/h  # 数据管理层
   ├── FileManager.cpp/h  # 文件读写管理
   ├── UserInterface.cpp/h # 用户界面交互
   ├── Person.h/tpp       # 联系人模板类
   ├── contactList/       # 联系人数据文件目录
       ├── a.txt
       ├── b.txt
       └── ...
```

## 数据格式

联系人数据使用 `|` 作为字段分隔符：

```
id|姓名|性别|年龄|电话|城市|学校|地址
```

示例：

```
a|张三|男|20|13800000001|北京|北京大学|北京市海淀区
```

## 编译运行

### 编译

```bash
cd src
g++ -std=c++17 -o contactManager.exe main.cpp App.cpp Service.cpp DataManager.cpp FileManager.cpp UserInterface.cpp Person.tpp
```

### 运行

```bash
./contactManager.exe
```

## 使用说明

### 主菜单

```
             联系人管理系统 ContactManager

  1. 查看文件列表（从 contactList/ 选择并加载）
  2. 查询全部已录入人员信息
  3. 删除已记录人员信息（按姓名删除）
  4. 修改已记录人员信息（按姓名覆盖更新）
  5. 添加特定人员的联系人信息
  6. 保存特定人员的所有通讯录信息
  7. 构建联系人关系网络
  0. 退出程序
```

### 操作提示

- 在任何输入过程中，输入 `0` 可以取消当前操作并返回主菜单
- 性别只能输入 `男` 或 `女`
- 年龄必须为数字
- 电话、城市、学校、地址等字段留空会自动填充为"未填写"

## 技术实现

### 语言与标准

- **C++17** 标准，使用现代 C++ 特性

### 架构设计

采用**分层架构**，职责分离清晰：

```
┌─────────────────────────────────────┐
│         UserInterface (UI层)        │  用户交互、输入输出
├─────────────────────────────────────┤
│              App (控制层)            │  流程控制、菜单调度
├─────────────────────────────────────┤
│           Service (业务层)           │  业务逻辑、数据解析
├─────────────────────────────────────┤
│         DataManager (数据层)         │  内存数据管理、CRUD操作
├─────────────────────────────────────┤
│         FileManager (持久层)         │  文件读写、目录遍历
└─────────────────────────────────────┘
```

### 核心技术

| 技术                             | 应用场景                                  |
| :------------------------------- | :---------------------------------------- |
| **模板类 `Person<>`**            | 联系人数据结构，支持泛型 ID 类型          |
| **STL 容器**                     | `std::vector`、`std::list` 存储联系人集合 |
| **字符串流 `std::stringstream`** | 数据解析与格式化                          |
| **文件流 `std::fstream`**        | 文件读写操作                              |

### 数据结构

- **`std::list<Person<>>`**：主数据容器，支持高效插入删除
- **`std::vector<IdType>`**：联系人关系列表
- **`std::vector<std::vector<double>>`**：关系网络邻接矩阵

### 输入处理

- 统一使用 **`std::getline()`** 读取输入，避免 `cin >>` 与 `getline` 混用导致的缓冲区问题
- 使用 **`|` 分隔符** 解析和存储数据，支持字段包含空格
- 输入验证：性别、年龄等字段的合法性检查
- 空输入处理：自动填充默认值 "未填写"

### 平台相关

- **Windows API**：`FindFirstFileA`/`FindNextFileA` 遍历目录文件
- **控制台编码**：`SetConsoleOutputCP(CP_UTF8)` 支持中文显示
- **`Sleep()`**：操作反馈延时

### 设计模式

- **MVC 模式**：Model（Person/DataManager）、View（UserInterface）、Controller（App/Service）
- **单一职责原则**：每个类专注于特定功能

## 注意事项

1. 确保 `contactList/` 目录存在且包含有效的联系人文件
2. 文件编码需为 UTF-8
3. 程序在 Windows 环境下编译运行
